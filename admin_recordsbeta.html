<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Master Record | CMCS VLS</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .bg-cmcs-blue { background-color: #0070c0; }
        .bg-cmcs-sidebar { background-color: #00b0f0; }
        .bg-cmcs-yellow { background-color: #ffff00; }
        .bg-cmcs-logout { background-color: #cc0000; }
        
        .sidebar-link { padding: 12px 20px; display: block; color: white; font-weight: bold; text-transform: uppercase; font-size: 14px; border-bottom: 1px solid rgba(255,255,255,0.2); }
        .active-tab { background-color: #ffff00; color: black; }
        
        table { width: 100%; border-collapse: collapse; font-size: 10px; margin-top: 5px; }
        th { background-color: #d9d9d9; border: 1px solid black; padding: 6px; text-align: left; font-weight: bold; text-transform: uppercase; }
        td { border: 1px solid black; padding: 6px; background-color: #ffffff; text-transform: uppercase; }
        
        .filter-container { border: 1px solid black; padding: 1px; display: flex; align-items: stretch; height: 38px; background: white; }
        .filter-box { border-right: 1px solid black; display: flex; flex-direction: column; justify-content: center; padding: 0 8px; flex: 1; }
        .filter-label { font-size: 9px; font-weight: bold; text-transform: uppercase; line-height: 1; margin-bottom: 2px; }
        .filter-select { outline: none; background: transparent; font-size: 11px; width: 100%; font-weight: bold; text-transform: uppercase; }

        .modal-overlay { background-color: rgba(0,0,0,0.6); position: fixed; inset: 0; display: none; align-items: center; justify-content: center; z-index: 100; }
        .modal-container { background: white; border: 2px solid black; width: 850px; box-shadow: 8px 8px 0px 0px black; }

        #printMasterHeader { display: none; }
        
        @media print {
            .no-print { display: none !important; }
            body { padding: 0; margin: 0; color: black !important; }
            table { font-size: 9px; width: 100% !important; }
            th { background-color: #f0f0f0 !important; -webkit-print-color-adjust: exact; }
            body:not(.modal-open) #printMasterHeader { display: flex !important; flex-direction: column; align-items: center; margin-bottom: 20px; }
            body.modal-open .modal-overlay { position: static; background: white; display: block !important; }
            body.modal-open .modal-container { box-shadow: none; border: none; width: 100%; position: static; }
            body.modal-open aside, body.modal-open nav, body.modal-open main > *:not(.modal-overlay) { display: none !important; }
        }
    </style>
</head>
<body class="bg-white min-h-screen flex flex-col font-sans">
    <nav class="bg-cmcs-blue text-white flex justify-between items-center h-12 no-print">
        <div class="flex items-center px-4 gap-2 font-bold text-sm uppercase">CMCS Virtual Learning System</div>
        <div class="flex items-center h-full">
            <div class="flex gap-4 px-6 items-center text-xs italic uppercase"><span id="adminName">Loading...</span></div>
            <button onclick="logout()" class="bg-cmcs-logout h-full px-8 text-white font-bold text-xs uppercase">Logout</button>
        </div>
    </nav>

    <div class="flex flex-1">
        <aside class="w-48 bg-cmcs-sidebar flex flex-col no-print">
            <a href="admin_approvalbeta.html" class="sidebar-link">APPROVALS</a>
            <a href="admin_setupbeta.html" class="sidebar-link">ACADEMIC SETUP</a>
            <a href="admin_classbeta.html" class="sidebar-link">CLASS ASSIGNMENT</a>
            <a href="admin_recordsbeta.html" class="sidebar-link active-tab">MASTER RECORD</a>
            <a href="admin_accountsbeta.html" class="sidebar-link">ACCOUNTS</a>
        </aside>

        <main class="flex-1 p-6">
            <div id="printMasterHeader">
                <img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.jpg" class="w-20 h-20 mb-2">
                <h1 class="font-bold text-2xl uppercase">CENTRAL MINDANAO COMPUTER SCHOOL</h1>
                <p class="text-[10px] uppercase tracking-[0.2em] font-bold">Master Student Academic Enrollment List</p>
                <p id="printFilterInfo" class="text-[9px] mt-2 font-bold uppercase text-gray-700"></p>
                <p class="text-[8px] mt-1 italic" id="printDate"></p>
                <hr class="border-black w-full my-4">
            </div>

            <div class="flex justify-between items-end mb-4 no-print">
                <h2 class="text-[12px] font-bold uppercase border-b-2 border-black inline-block">MASTER RECORD LIST</h2>
                <div class="flex gap-2">
                    <button onclick="exportCSV()" class="bg-green-600 text-white border border-black px-4 py-1 text-[10px] font-bold shadow-[2px_2px_0px_0px_black] hover:bg-green-700 uppercase">Export CSV</button>
                    <button onclick="window.print()" class="bg-white border border-black px-4 py-1 text-[10px] font-bold shadow-[2px_2px_0px_0px_black] hover:bg-gray-100 uppercase">Print All</button>
                </div>
            </div>

            <div class="flex items-start gap-4 mb-6 no-print">
                <div class="filter-container flex-1">
                    <div class="filter-box" style="flex: 2;">
                        <span class="filter-label">COURSE</span>
                        <select id="filterCourse" class="filter-select"><option value="ALL">ALL COURSES</option></select>
                    </div>
                    <div class="filter-box">
                        <span class="filter-label">YEAR</span>
                        <select id="filterYear" class="filter-select">
                            <option value="ALL">ALL YEARS</option>
                            <option value="1ST YEAR">1ST YEAR</option>
                            <option value="2ND YEAR">2ND YEAR</option>
                            <option value="3RD YEAR">3RD YEAR</option>
                            <option value="4TH YEAR">4TH YEAR</option>
                        </select>
                    </div>
                    <div class="filter-box" style="border-right: none;">
                        <span class="filter-label">SEM</span>
                        <select id="filterSem" class="filter-select">
                            <option value="ALL">ALL SEMESTERS</option>
                            <option value="1ST SEMESTER">1ST SEMESTER</option>
                            <option value="2ND SEMESTER">2ND SEMESTER</option>
                            <option value="SUMMER">SUMMER</option>
                        </select>
                    </div>
                </div>
                <div class="filter-container w-64">
                    <div class="filter-box" style="border:none;">
                        <span class="filter-label">SEARCH NAME/ID</span>
                        <input type="text" id="searchField" class="filter-select outline-none" placeholder="...">
                    </div>
                </div>
            </div>

            <table>
                <thead>
                    <tr>
                        <th width="30">NO.</th>
                        <th width="100">STUDENT ID</th>
                        <th>FULL NAME</th>
                        <th>S.Y. / COURSE / YR / SEM</th>
                        <th>ENROLLED</th>
                        <th width="80" class="no-print">ACTION</th>
                    </tr>
                </thead>
                <tbody id="masterTableBody"></tbody>
            </table>
        </main>
    </div>

    <div id="viewModal" class="modal-overlay">
        <div class="modal-container">
            <div class="bg-cmcs-blue text-white p-3 font-bold text-xs flex justify-between uppercase no-print">
                <span>Student Academic Profile</span>
                <button onclick="closeModal('viewModal')" class="font-bold">X</button>
            </div>
            <div id="printArea" class="p-8">
                <div class="flex items-center justify-center gap-4 mb-6">
                    <img src="https://sklepagatesting.github.io/resources/Images/CMCSlogo.jpg" class="w-16 h-16">
                    <div class="text-center">
                        <h1 class="font-bold text-lg uppercase">CENTRAL MINDANAO COMPUTER SCHOOL</h1>
                        <p class="text-[10px] uppercase font-bold tracking-widest">Official Student Academic Record</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 border-y border-black py-4 mb-4">
                    <div class="text-[11px] space-y-1">
                        <p><strong>NAME:</strong> <span id="vName"></span></p>
                        <p><strong>ID NUMBER:</strong> <span id="vId"></span></p>
                        <p><strong>GENDER:</strong> <span id="vGender"></span></p>
                        <p><strong>SCHOOL YEAR:</strong> <span id="vSY"></span></p>
                    </div>
                    <div class="text-[11px] space-y-1">
                        <p><strong>COURSE:</strong> <span id="vCourse"></span></p>
                        <p><strong>YEAR / SEM:</strong> <span id="vLevel"></span></p>
                        <p><strong>EMAIL:</strong> <span id="vEmail" class="lowercase"></span></p>
                    </div>
                </div>

                <h4 class="font-bold text-[10px] uppercase mb-2">Class Schedule & Program Details</h4>
                <table class="w-full border-black">
                    <thead>
                        <tr>
                            <th class="text-[9px]" width="80">CODE</th>
                            <th class="text-[9px]">SUBJECT NAME</th>
                            <th class="text-[9px]">INSTRUCTOR</th>
                            <th class="text-[9px]">TIME & DAY SCHEDULE</th>
                        </tr>
                    </thead>
                    <tbody id="vSubjectTable"></tbody>
                </table>

                <div class="mt-16 flex justify-between text-[10px] font-bold uppercase">
                    <div class="border-t border-black pt-1 w-48 text-center">Registrar Signature</div>
                    <div class="border-t border-black pt-1 w-48 text-center">School Director</div>
                </div>
            </div>
            <div class="p-4 bg-gray-100 border-t border-black flex justify-end gap-2 no-print">
                <button onclick="window.print()" class="bg-cmcs-yellow border border-black px-6 py-2 font-bold text-[10px] uppercase shadow-[2px_2px_0px_0px_black]">Print Individual</button>
                <button onclick="closeModal('viewModal')" class="bg-white border border-black px-6 py-2 font-bold text-[10px] uppercase">Close</button>
            </div>
        </div>
    </div>
